{% load humanize %}
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script>
        $(document).ready(function(){
            $("#commenters").on("click", ".reply", function(event){
                event.preventDefault();
                var form = $("#postcomment").clone(true);
                
                form.find('.parent').val($(this).parent().parent().attr('id'));
                $(this).parent().append(form);
            });
            $('.error').hide();
            $('#postcomment').bind("click", function() { 
                if($('#id_content').val()== ''){
                    // alert($('input[name="content"]').val());
                    $('.error').show();
                    $("#id_content").focus();
                    return false;
                }
                if($('#id_rating').val()== ''){
                    $('.error').show();
                    return false;
                }
                
                    $.ajax({ 
                        data: $(this).serialize(), 
                        type:"POST", 
                        url: /comment/, 
                        success: function() { 
                            $('#mgs').show();
                            setTimeout(function() { $("#mgs").hide(); }, 5000);
                             $('.error').hide();

                        },                           
                        });
                    
            
                $("#postcomment")[0].reset();
                return false;
             });
            
           $(".submit").click(function(){
            $('#signin_popup').show();
            $('.popup_fade').show();
           });
        });
    </script>
    <style>
        a {
            font-weight: bold;
           
            text-decoration: none;
        }

        a:hover {
            text-decoration: underline;
        }
        
        #commenters {
            padding-left: 0px;
        }
        
            #commenters li {
                list-style-type: none;
            }
        
        .poster {
            font-size: 12px;
            color: #AAAAAA;
            margin: 0 0 0 15px;
        }
        
        #postcomment ul {
            padding-left: 0px;
        }
        
            #postcomment ul li {
                list-style-type:  none;
                /*padding-bottom: 5px;*/
            }
                
        #postcomment label {
            width: 74px;
            display: inline-block;
        }
        
        .c {
            font-size: 14px;
           
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            
            padding: 10px;
            margin-bottom: 10px;
        }
    </style>
    {% if request.user.is_authenticated %}
     <form id="postcomment" method="post" action="{% url 'reviews.views.comment' %}" class="postcomment">
         {% csrf_token %}
       <!--  {{comment_form.as_p}}
         <span class="error" style="color:red;">Enter your Comments</span>
 -->
        <div class="content">
                {{ comment_form.non_field_errors }}
                        <div class="field_wapper">
                            <label for="id_content">{{ comment_form.content.label_tag }}</label>
                                {{comment_form.content.errors}}
                                {{ comment_form.content }}
                            <span class="error">Enter your content</span>
                           
                       </div>
                       <div class="field_wapper">
                            <label for="id_rating">{{ comment_form.rating.label_tag }}</label>
                                {{comment_form.rating.errors}}
                                {{ comment_form.rating }}
                            <span class="error">Enter your rating</span>
                           <input id="id_parent" class="parent" type="hidden" name="parent">
                       </div>
                   </div>
                <p><input type="submit" value="Submit" id="submit" /></p>
        {% csrf_token %}
         <input type='hidden' name="postent" value="{{events.id}}" />
    </form>
     <div id="mgs" style="display:none"> Your comment Sucessfully posted</div>
     
 {% else %}
     <form id="postcomment" method="post" action="">
        {{comment_form.as_p}}
        <p class="submit"><input type="button" value="Login" id="submit" /></p>
        {% csrf_token %}
         <input type='hidden' name="postent" value="{{events.id}}" />

    </form>
 {% endif %}
    <ul id="commenters">
    {% for c in comment_tree %}     
        <li id="{{c.id}}" class="c" style="margin-left:{{c.depth|add:c.depth}}em;">
            
            <p><i class="fa fa-user"></i></p>
            <p>{{c.name}} <code class="poster"> {{c.date|naturaltime}}</code></p>
            <p>{{c.content}}</p>
            <p><a href="" class="reply">reply</a></p>
        </li>
    {% empty %}
        <li>There are currently no comments. You can be first!</li>
    {% endfor %}
    
    </ul>
